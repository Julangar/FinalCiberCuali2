clear all;
close all;
h=0.001;x1=0.1;x11=0.1;x2=0.1;x22=0.2;x3=0.1;x33=0.1;t(1)=0;n=1;v=0.5;a=0.4;
y(:,1)=[0.1;0.1;0.1];
y1(:,1)=[0.1;0.2;0.1];
for k=1:40000
 k1=h*(-v*x1+2*x2);
 m1=h*(-v*x2+(x3-a)*x1);
 r1=h*(1-x1*x2);
 k2=h*(-v*(x1+(k1/2))+2*(x2+m1/2));
 m2=h*(-v*(x2+(m1/2))+((x3+(r1/2))-a)*(x1+(k1/2)));
 r2=h*(1-(x1+(k1/2))*(x2+(m1/2)));
 k3=h*(-v*(x1+(k2/2))+2*(x2+m2/2));
 m3=h*(-v*(x2+(m2/2))+((x3+(r2/2))-a)*(x1+(k2/2)));
 r3=h*(1-(x1+(k2/2))*(x2+(m2/2)));
 k4=h*(-v*(x1+(k3))+2*(x2+m3));
 m4=h*(-v*(x2+(m3))+((x3+(r3))-a)*(x1+(k3)));
 r4=h*(1-(x1+(k3))*(x2+(m3)));
 x1=x1+(1/6)*(k1+2*k2+2*k3+k4);
 x2=x2+(1/6)*(m1+2*m2+2*m3+m4);
 x3=x3+(1/6)*(r1+2*r2+2*r3+r4);

 k11=h*(-v*x11+2*x22);
 m11=h*(-v*x22+(x33-a)*x11);
 r11=h*(1-x11*x22);
 k22=h*(-v*(x11+(k11/2))+2*(x22+m11/2));
 m22=h*(-v*(x22+(m11/2))+((x33+(r11/2))-a)*(x11+(k11/2)));
 r22=h*(1-(x11+(k11/2))*(x22+(m11/2)));
 k33=h*(-v*(x11+(k22/2))+2*(x22+m22/2));
 m33=h*(-v*(x22+(m22/2))+((x33+(r22/2))-a)*(x11+(k22/2)));
 r33=h*(1-(x11+(k22/2))*(x22+(m22/2)));
 k44=h*(-v*(x11+(k33))+2*(x22+m33));
 m44=h*(-v*(x22+(m33))+((x33+(r33))-a)*(x11+(k33)));
 r44=h*(1-(x11+(k33))*(x22+(m33)));
 x11=x11+(1/6)*(k11+2*k22+2*k33+k44);
 x22=x22+(1/6)*(m11+2*m22+2*m33+m44);
 x33=x33+(1/6)*(r11+2*r22+2*r33+r44);

 n=n+1;
 t(n)=(n-1)*h;
 y(:,n)=[x1,x2,x3];
 y1(:,n)=[x11,x22,x33];
end
plot3(y(1,:),y(2,:),y(3,:),y1(1,:),y1(2,:),y1(3,:))
grid
